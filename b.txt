Decryption
Áp dụng bảng hoá vị PC-2 thu được các khoá K1,K2,…K16
K1: 110010100001110110111001110110111111000100101001
K2: 000010111110000010100011001011011100111011101111
K3: 101110010000110110111110000111101101110011010011
K4: 111101000010001010001001100011111100010101110101
K5: 000100111001111000110100100010111110111111000000
K6: 110011000011100011010110111110001100011100010101
K7: 001101101110011001101100110110110100011010001110
K8: 110010100101010100100010110111000111001110001001
K9: 010101111010001001100011001111011010110010110101
K10: 101010111101010010110010011010110100110011010111
K11: 111111000000001111001110000011111110000110011111
K12: 001100101101001000011001101001110101010111000101
K13: 000011010001100101110110110010101000001111100111
K14: 101001100110100011011101110101101100111110001101
K15: 000111110110011100100000010110100001011111011001
K16: 011101111000100101001101111011001011010011110110
Bước 2:
Bản rõ qua phép IP(64b):  0011011001000001111001000001010000001101100100111110111100111011
L0: 00110110010000011110010000010100
R0: 00001101100100111110111100111011
Bước 3:
Vòng lặp 1:
K1 = 011101111000100101001101111011001011010011110110
L1 = R0 = 00001101100100111110111100111011
E(R0) = 100001011011110010100111111101011110100111110110
K1 XOR E(R0) = 111100100011010111101010000110010101110100000000
S1[2][14] = 5 = 0101
S2[3][1] = 8 = 1000
S3[1][11] = 14 = 1110
S4[2][5] = 11 = 1011
S5[0][3] = 1 = 0001
S6[1][10] = 13 = 1101
S7[2][10] = 6 = 0110
S8[0][0] = 13 = 1101
Đầu ra của S-box: 01011000111010110001110101101101
Hoán vị P các đầu ra của S-box = 10111000010110011010110101101110
R1 = L0 XOR f(R0,K1) = 10001110000110000100100101111010
Vòng lặp 2:
K2 = 000111110110011100100000010110100001011111011001
L2 = R1 = 10001110000110000100100101111010
E(R1) = 010001011100000011110000001001010010101111110101
K2 XOR E(R1) = 010110101010011111010000011111110011110000101100
S1[0][11] = 12 = 1100
S2[2][5] = 4 = 0100
S3[1][15] = 1 = 0001
S4[0][8] = 1 = 0001
S5[1][15] = 6 = 0110
S6[3][9] = 14 = 1110
S7[2][8] = 10 = 1010
S8[2][6] = 14 = 1110
Đầu ra của S-box: 11000100000100010110111010101110
Hoán vị P các đầu ra của S-box = 10011100101001101000010010111001
R2 = L1 XOR f(R1,K2) = 10010001001101010110101110000010
Vòng lặp 3:
K3 = 101001100110100011011101110101101100111110001101
L3 = R2 = 10010001001101010110101110000010
E(R2) = 010010100010100110101010101101010111110000000101
K3 XOR E(R2) = 111011000100000101110111011000111011001110001000
S1[3][13] = 0 = 0000
S2[0][2] = 8 = 1000
S3[1][2] = 0 = 0000
S4[3][11] = 11 = 1011
S5[0][12] = 13 = 1101
S6[3][13] = 0 = 0000
S7[0][7] = 13 = 1101
S8[0][4] = 6 = 0110
Đầu ra của S-box: 00001000000010111101000011010110
Hoán vị P các đầu ra của S-box = 10100011010111100000000001100001
R3 = L2 XOR f(R2,K3) = 00101101010001100100100100011011
Vòng lặp 4:
K4 = 000011010001100101110110110010101000001111100111
L4 = R3 = 00101101010001100100100100011011
E(R3) = 100101011010101000001100001001010010100011110110
K4 XOR E(R3) = 100110001011001101111010111011111010101100010001
S1[2][3] = 8 = 1000
S2[1][5] = 2 = 0010
S3[1][6] = 6 = 0110
S4[2][13] = 2 = 0010
S5[3][13] = 4 = 0100
S6[2][13] = 13 = 1101
S7[2][6] = 7 = 0111
S8[1][8] = 12 = 1100
Đầu ra của S-box: 10000010011000100100110101111100
Hoán vị P các đầu ra của S-box = 01011010110101010010010000101100
R4 = L3 XOR f(R3,K4) = 11001011111000000100111110101110
Vòng lặp 5:
K5 = 001100101101001000011001101001110101010111000101
L5 = R4 = 11001011111000000100111110101110
E(R4) = 011001010111111100000000001001011111110101011101
K5 XOR E(R4) = 010101111010110100011001100000101010100010011000
S1[1][10] = 12 = 1100
S2[2][13] = 3 = 0011
S3[2][10] = 2 = 0010
S4[1][12] = 1 = 0001
S5[2][0] = 4 = 0100
S6[2][5] = 8 = 1000
S7[2][1] = 4 = 0100
S8[0][12] = 5 = 0101
Đầu ra của S-box: 11000011001000010100100001000101
Hoán vị P các đầu ra của S-box = 11010000100101001100100000100100
R5 = L4 XOR f(R4,K5) = 11111101110100101000000100111111
Vòng lặp 6:
K6 = 111111000000001111001110000011111110000110011111
L6 = R5 = 11111101110100101000000100111111
E(R5) = 111111111011111010100101010000000010100111111111
K6 XOR E(R5) = 000000111011110101101011010011111100100001100000
S1[0][0] = 14 = 1110
S2[3][13] = 5 = 0101
S3[3][10] = 14 = 1110
S4[3][5] = 1 = 0001
S5[1][9] = 0 = 0000
S6[2][14] = 11 = 1011
S7[3][0] = 6 = 0110
S8[2][0] = 7 = 0111
Đầu ra của S-box: 11100101111000010000101101100111
Hoán vị P các đầu ra của S-box = 10010000101100111110111100110100
R6 = L5 XOR f(R5,K6) = 01011011010100111010000010011010
Vòng lặp 7:
K7 = 101010111101010010110010011010110100110011010111
L7 = R6 = 01011011010100111010000010011010
E(R6) = 001011110110101010100111110100000001010011110100
K7 XOR E(R6) = 100001001011111000010101101110110101100000100011
S1[3][0] = 15 = 1111
S2[1][5] = 2 = 0010
S3[2][12] = 5 = 0101
S4[1][10] = 2 = 0010
S5[2][7] = 8 = 1000
S6[3][10] = 1 = 0001
S7[2][0] = 1 = 0001
S8[3][1] = 1 = 0001
Đầu ra của S-box: 11110010010100101000000100010001
Hoán vị P các đầu ra của S-box = 01000111110000011010101000000010
R7 = L6 XOR f(R6,K7) = 10111010000100110010101100111101
Vòng lặp 8:
K8 = 010101111010001001100011001111011010110010110101
L8 = R7 = 10111010000100110010101100111101
E(R7) = 110111110100000010100110100101010110100111111011
K8 XOR E(R7) = 100010001110001011000101101010001100010101001110
S1[2][1] = 1 = 0001
S2[0][7] = 4 = 0100
S3[1][5] = 4 = 0100
S4[1][2] = 11 = 1011
S5[2][5] = 13 = 1101
S6[0][6] = 6 = 0110
S7[1][10] = 5 = 0101
S8[0][7] = 1 = 0001
Đầu ra của S-box: 00010100010010111101011001010001
Hoán vị P các đầu ra của S-box = 10100011011101010000100001011010
R8 = L7 XOR f(R7,K8) = 11111000001001101010100011000000
Vòng lặp 9:
K9 = 110010100101010100100010110111000111001110001001
L9 = R8 = 11111000001001101010100011000000
E(R8) = 011111110000000100001101010101010001011000000001
K9 XOR E(R8) = 101101010101010000101111100010010110010110001000
S1[3][6] = 1 = 0001
S2[1][10] = 1 = 0001
S3[0][8] = 1 = 0001
S4[3][7] = 8 = 1000
S5[2][1] = 2 = 0010
S6[0][11] = 4 = 0100
S7[0][11] = 7 = 0111
S8[0][4] = 6 = 0110
Đầu ra của S-box: 00010001000110000010010001110110
Hoán vị P các đầu ra của S-box = 00000110000100100100010011101010
R9 = L8 XOR f(R8,K9) = 10111100000000010110111111010111
Vòng lặp 10:
K10 = 001101101110011001101100110110110100011010001110
L10 = R9 = 10111100000000010110111111010111
E(R9) = 110111111000000000000010101101011111111010101111
K10 XOR E(R9) = 111010010110011001101110011011101011100000100001
S1[2][13] = 10 = 1010
S2[0][11] = 13 = 1101
S3[1][12] = 12 = 1100
S4[2][7] = 13 = 1101
S5[1][13] = 9 = 1001
S6[3][5] = 5 = 0101
S7[2][0] = 1 = 0001
S8[3][0] = 2 = 0010
Đầu ra của S-box: 10101101110011011001010100010010
Hoán vị P các đầu ra của S-box = 10100011100010110111001101011000
R10 = L9 XOR f(R9,K10) = 01011011101011011101101110011000
Vòng lặp 11:
K11 = 110011000011100011010110111110001100011100010101
L11 = R10 = 01011011101011011101101110011000
E(R10) = 001011110111110101011011111011110111110011110000
K11 XOR E(R10) = 111000110100010110001101000101111011101111100101
S1[2][12] = 3 = 0011
S2[2][10] = 12 = 1100
S3[0][11] = 7 = 0111
S4[1][6] = 0 = 0000
S5[1][2] = 2 = 0010
S6[3][13] = 0 = 0000
S7[3][7] = 7 = 0111
S8[3][2] = 14 = 1110
Đầu ra của S-box: 00111100011100000010000001111110
Hoán vị P các đầu ra của S-box = 00001110000110110000011010110110
R11 = L10 XOR f(R10,K11) = 10110010000110100110100101100001
Vòng lặp 12:
K12 = 000100111001111000110100100010111110111111000000
L12 = R11 = 10110010000110100110100101100001
E(R11) = 110110100100000011110100001101010010101100000011
K12 XOR E(R11) = 110010011101111011000000101111101100010011000011
S1[2][9] = 12 = 1100
S2[1][14] = 11 = 1011
S3[3][13] = 5 = 0101
S4[0][0] = 7 = 0111
S5[3][7] = 13 = 1101
S6[2][6] = 12 = 1100
S7[1][9] = 3 = 0011
S8[1][1] = 15 = 1111
Đầu ra của S-box: 11001011010101111101110000111111
Hoán vị P các đầu ra của S-box = 11111111110011111101110000101000
R12 = L11 XOR f(R11,K12) = 10100100011000100000011110110000
Vòng lặp 13:
K13 = 111101000010001010001001100011111100010101110101
L13 = R12 = 10100100011000100000011110110000
E(R12) = 010100001000001100000100000000001111110110100001
K13 XOR E(R12) = 101001001010000110001101100011110011100011010100
S1[3][4] = 4 = 0100
S2[0][5] = 11 = 1011
S3[0][3] = 14 = 1110
S4[1][6] = 0 = 0000
S5[3][1] = 8 = 1000
S6[3][9] = 14 = 1110
S7[3][1] = 11 = 1011
S8[0][10] = 3 = 0011
Đầu ra của S-box: 01001011111000001000111010110011
Hoán vị P các đầu ra của S-box = 01010011001010111100110100001101
R13 = L12 XOR f(R12,K13) = 11100001001100011010010001101100
Vòng lặp 14:
K14 = 101110010000110110111110000111101101110011010011
L14 = R13 = 11100001001100011010010001101100
E(R13) = 011100000010100110100011110100001000001101011001
K14 XOR E(R13) = 110010010010010000011101110011100101111110001010
S1[2][9] = 12 = 1100
S2[0][9] = 7 = 0111
S3[0][8] = 1 = 0001
S4[1][14] = 14 = 1110
S5[3][9] = 15 = 1111
S6[3][2] = 2 = 0010
S7[2][15] = 2 = 0010
S8[0][5] = 15 = 1111
Đầu ra của S-box: 11000111000111101111001000101111
Hoán vị P các đầu ra của S-box = 01101101111001101101110011110000
R14 = L13 XOR f(R13,K14) = 11001001100001001101101101000000
Vòng lặp 15:
K15 = 000010111110000010100011001011011100111011101111
L15 = R14 = 11001001100001001101101101000000
E(R14) = 011001010011110000001001011011110110101000000001
K15 XOR E(R14) = 011011101101110010101010010000101010010011101110
S1[1][13] = 5 = 0101
S2[3][6] = 4 = 0100
S3[2][9] = 1 = 0001
S4[2][5] = 11 = 1011
S5[0][8] = 8 = 1000
S6[2][5] = 8 = 1000
S7[1][9] = 3 = 0011
S8[2][7] = 2 = 0010
Đầu ra của S-box: 01010100000110111000100000110010
Hoán vị P các đầu ra của S-box = 10010111010000101000010001010010
R15 = L14 XOR f(R14,K15) = 01110110011100110010000000111110
Vòng lặp 16:
K16 = 110010100001110110111001110110111111000100101001
L16 = R15 = 01110110011100110010000000111110
E(R15) = 001110101100001110100110100100000000000111111100
K16 XOR E(R15) = 111100001101111000011111010010111111000011010101
S1[2][14] = 5 = 0101
S2[1][6] = 8 = 1000
S3[2][12] = 5 = 0101
S4[1][15] = 9 = 1001
S5[0][9] = 5 = 0101
S6[3][15] = 13 = 1101
S7[1][1] = 0 = 0000
S8[1][10] = 6 = 0110
Đầu ra của S-box: 01011000010110010101110100000110
Hoán vị P các đầu ra của S-box = 10110100000011111010000001101010
R16 = L15 XOR f(R15,K16) = 01111101100010110111101100101010
Bước 4:
R16L16 = 0111110110001011011110110010101001110110011100110010000000111110
Bước 5:
Hoán vị IP-1 = 0111010010110111110000100101011111100110111011111110010000010000
Bản rõ :  74B7C257E6EFE410